{"version":3,"file":"Index-c0795f32.js","sources":["../../src/views/logs/Index.vue"],"sourcesContent":["<template>\n  <main class=\"flex flex-col gap-4\">\n    <div class=\"flex flex-col md:flex-row items-center justify-between gap-2 md:gap-6\">\n      <div class=\"my-6 w-full md:w-6/12 flex flex-wrap gap-4 items-center justify-around\">\n        <easiSearch\n          class=\"grow\"\n          v-model=\"searchText\"\n          @keyup=\"handleSearch\"\n          @search=\"handleSearch\"\n        />\n        <!-- <Filter /> -->\n      </div>\n      <easiPaginate\n        :data=\"adminLogs\"\n        info-only\n        @page:update=\"updatePage\"\n        :currentPage=\"currentPage\"\n        v-model:pageSize=\"pageSize\"\n        :visibleData=\"visibleData\"\n      />\n    </div>\n\n    <DataTable\n      v-model:selection=\"selectLogs\"\n      id=\"table-style\"\n      scrollable\n      removableSort\n      :value=\"visibleData\"\n      @rowSelect=\"onRowSelect\"\n      @rowUnselect=\"onRowUnselect\"\n    >\n      <Column selectionMode=\"multiple\" headerStyle=\"width: 2rem\"> </Column>\n      <Column style=\"white-space: nowrap\" sortable field=\"admin\" header=\"Admin\">\n        <template #body=\"slotProps\">\n          <div class=\"applicant\">\n            <div class=\"applicant-avatar\">\n              <img\n                v-if=\"slotProps.data.user.pfp\"\n                :src=\"slotProps.data.user.pfp\"\n                alt=\"\"\n                class=\"object-cover h-full w-full\"\n              />\n              <span\n                v-else\n                class=\"w-full h-full bg-primary flex items-center justify-center text-white font-medium;\"\n                >{{\n                  initials(`${slotProps.data.user.firstName} ${slotProps.data.user.lastName}`)\n                }}</span\n              >\n            </div>\n            <div class=\"applicant-name\">\n              {{ `${slotProps.data.user.firstName} ${slotProps.data.user.lastName}` }}\n            </div>\n          </div>\n        </template>\n      </Column>\n      <Column sortable field=\"activity\" header=\"Activity\"> </Column>\n      <Column field=\"groupName\" header=\"Section\"></Column>\n\n      <Column sortable style=\"white-space: nowrap\" field=\"createdAt\" header=\"Time\">\n        <template #body=\"slotProps\">\n          <div>\n            {{ formatDate(slotProps.data.createdAt, 'time') }}\n          </div>\n        </template>\n      </Column>\n      <Column sortable style=\"white-space: nowrap\" field=\"createdAt\" header=\"Date\">\n        <template #body=\"slotProps\">\n          <div>\n            {{ formatDate(slotProps.data.createdAt) }}\n          </div>\n        </template>\n      </Column>\n    </DataTable>\n\n    <easiPaginate\n      :data=\"adminLogs\"\n      @page:update=\"updatePage\"\n      :currentPage=\"currentPage\"\n      v-model:pageSize=\"pageSize\"\n      :visibleData=\"visibleData\"\n    />\n\n    <easiLoader v-if=\"loading\" />\n  </main>\n</template>\n\n<script setup>\nimport Filter from './LogFilter.vue'\n\nimport { computed, onMounted, ref, watch } from 'vue'\nimport { useDataStore } from '@/stores/data.js'\nimport { useToast } from 'vue-toastification'\nimport { helperFunctions } from '@/composable/helperFunctions'\n\nconst { formatAmount, formatDate, initials } = helperFunctions\nconst toast = useToast()\nconst store = useDataStore()\nconst { query } = store\n\nconst searchText = ref('')\nconst selectLogs = ref([])\n\nconst loading = ref(false)\nconst visibleData = ref([])\nconst adminLogs = computed(() => store.getAdminLogs)\n\nconst currentPage = ref(0)\nconst pageSize = ref(10)\n\nconst updatePage = (pageNumber) => {\n  currentPage.value = pageNumber\n  updateVisibleData()\n}\n\nconst updateVisibleData = () => {\n  let datas = adminLogs.value\n  visibleData.value = datas.slice(\n    currentPage.value * pageSize.value,\n    currentPage.value * pageSize.value + pageSize.value\n  )\n\n  // if we have 0 visible todos, go back a page\n  if (visibleData.value.length == 0 && currentPage.value > 0) {\n    updatePage(currentPage.value - 1)\n  }\n}\n\nconst onRowSelect = (event) => {\n  selectLogs.value.push(event.data)\n}\nconst onRowUnselect = (event) => {\n  selectLogs.value = selectLogs.value.filter((el) => {\n    return el._id !== event.data._id\n  })\n}\n\nconst handleSearch = () => {\n  const text = searchText.value.toLowerCase()\n  console.log(text)\n  if (text.trim() !== '') {\n    visibleData.value = adminLogs.value.filter(\n      (el) =>\n        el.user.firstName.toLowerCase().includes(text) ||\n        el.user.lastName.toLowerCase().includes(text) ||\n        el.activity.toLowerCase().includes(text)\n    )\n  } else {\n    updateVisibleData()\n  }\n}\n\nwatch(searchText, () => {\n  handleSearch()\n})\n\nwatch(adminLogs, () => {\n  updateVisibleData()\n})\n\nonMounted(() => {\n  updateVisibleData()\n})\n\nconst queryAdminLogs = async (arg) => {\n  try {\n    loading.value = true\n\n    const payload = {\n      pagination: {\n        page: 9,\n        limit: null\n      },\n      filter: {\n        company: 'ASC',\n        amount: null\n      }\n    }\n\n    console.log(arg)\n\n    const res = await query({\n      endpoint: 'ListAdminActivities',\n      payload: {\n        input: arg ? arg : payload\n      },\n      storeKey: 'adminLogs'\n    })\n\n    loading.value = false\n  } catch (error) {\n    loading.value = false\n    console.log(error.message)\n  }\n}\n\nqueryAdminLogs()\n</script>\n\n<style lang=\"scss\"></style>\n"],"names":["formatAmount","formatDate","initials","helperFunctions","useToast","store","useDataStore","query","searchText","ref","selectLogs","loading","visibleData","adminLogs","computed","currentPage","pageSize","updatePage","pageNumber","updateVisibleData","datas","onRowSelect","event","onRowUnselect","el","handleSearch","text","watch","onMounted","arg","payload","res","error"],"mappings":"qjBA+FA,KAAM,CAAE,aAAAA,EAAc,WAAAC,EAAY,SAAAC,CAAQ,EAAKC,EACjCC,EAAU,EACxB,MAAMC,EAAQC,EAAc,EACtB,CAAE,MAAAC,CAAO,EAAGF,EAEZG,EAAaC,EAAI,EAAE,EACnBC,EAAaD,EAAI,EAAE,EAEnBE,EAAUF,EAAI,EAAK,EACnBG,EAAcH,EAAI,EAAE,EACpBI,EAAYC,EAAS,IAAMT,EAAM,YAAY,EAE7CU,EAAcN,EAAI,CAAC,EACnBO,EAAWP,EAAI,EAAE,EAEjBQ,EAAcC,GAAe,CACjCH,EAAY,MAAQG,EACpBC,EAAmB,CACrB,EAEMA,EAAoB,IAAM,CAC9B,IAAIC,EAAQP,EAAU,MACtBD,EAAY,MAAQQ,EAAM,MACxBL,EAAY,MAAQC,EAAS,MAC7BD,EAAY,MAAQC,EAAS,MAAQA,EAAS,KAC/C,EAGGJ,EAAY,MAAM,QAAU,GAAKG,EAAY,MAAQ,GACvDE,EAAWF,EAAY,MAAQ,CAAC,CAEpC,EAEMM,EAAeC,GAAU,CAC7BZ,EAAW,MAAM,KAAKY,EAAM,IAAI,CAClC,EACMC,EAAiBD,GAAU,CAC/BZ,EAAW,MAAQA,EAAW,MAAM,OAAQc,GACnCA,EAAG,MAAQF,EAAM,KAAK,GAC9B,CACH,EAEMG,EAAe,IAAM,CACzB,MAAMC,EAAOlB,EAAW,MAAM,YAAa,EAC3C,QAAQ,IAAIkB,CAAI,EACZA,EAAK,KAAM,IAAK,GAClBd,EAAY,MAAQC,EAAU,MAAM,OACjCW,GACCA,EAAG,KAAK,UAAU,YAAW,EAAG,SAASE,CAAI,GAC7CF,EAAG,KAAK,SAAS,YAAW,EAAG,SAASE,CAAI,GAC5CF,EAAG,SAAS,cAAc,SAASE,CAAI,CAC1C,EAEDP,EAAmB,CAEvB,EAEA,OAAAQ,EAAMnB,EAAY,IAAM,CACtBiB,EAAc,CAChB,CAAC,EAEDE,EAAMd,EAAW,IAAM,CACrBM,EAAmB,CACrB,CAAC,EAEDS,EAAU,IAAM,CACdT,EAAmB,CACrB,CAAC,GAEsB,MAAOU,GAAQ,CACpC,GAAI,CACFlB,EAAQ,MAAQ,GAEhB,MAAMmB,EAAU,CACd,WAAY,CACV,KAAM,EACN,MAAO,IACR,EACD,OAAQ,CACN,QAAS,MACT,OAAQ,IACT,CACF,EAED,QAAQ,IAAID,CAAG,EAEf,MAAME,EAAM,MAAMxB,EAAM,CACtB,SAAU,sBACV,QAAS,CACP,MAAOsB,GAAYC,CACpB,EACD,SAAU,WAChB,CAAK,EAEDnB,EAAQ,MAAQ,EACjB,OAAQqB,EAAP,CACArB,EAAQ,MAAQ,GAChB,QAAQ,IAAIqB,EAAM,OAAO,CAC1B,CACH,GAEgB"}