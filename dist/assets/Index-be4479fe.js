import{_ as se,a as le,U as te,M as ae,L as oe,C as ne,b as re}from"./location-8b461d59.js";import{s as j,C as Q,y as W,b as f,d as q,g as Y,H as K,m as y,o as m,c as x,i as d,a,F as P,e as G,n as X,t as L,u as g,I as z,G as H,D as J,x as I,j as $,l as ue,k as U,f as B,ah as ie,ai as ce}from"./index-351c9552.js";import{_ as de,E as me,R as fe}from"./removeIcon-e7818cde.js";import{C as pe}from"./confirm-cfbddac4.js";import"./CopyIcon-0dbe4dba.js";const ve={class:"flex flex-col gap-4 w-full"},_e={class:"flex flex-col gap-4 h-96 overflow-auto pr-1"},ge=["data","onClick"],he={class:"flex-shrink-0 w-10 h-10 rounded-full bg-primary overflow-hidden flex items-center justify-center"},ye=["src"],be={key:1,class:"text-white text-sm font-bold"},Ne={class:"flex flex-col capitalize"},xe={class:"text-dark-700 text-sm"},$e={class:"font-bold"},Ae={__name:"AdminList",setup(O){const V=j(),{initials:i}=z,N=Q(),R=W(),b=f(""),p=q(()=>V.getAdminUsers),_=f([]),h=c=>{if(c)return`${c.firstName} ${c.lastName}`};Y(()=>{_.value=p.value,N.query&&!N.query.id&&p.value.length&&R.push({query:{id:p.value[0]._id}})}),K(p,()=>{_.value=p.value,N.query&&!N.query.id&&p.value.length&&R.push({query:{id:p.value[0]._id}})});const v=()=>{b.value.trim()==""?_.value=p.value:_.value=p.value.filter(c=>c.firstName.toLocaleLowerCase().includes(b.value.toLocaleLowerCase())||c.lastName.toLocaleLowerCase().includes(b.value.toLocaleLowerCase())),console.log(_.value)};return(c,e)=>{const n=y("easiSearch");return m(),x("div",ve,[d(n,{onSearch:v,onKeyup:v,placeholder:"Search...",modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=o=>b.value=o)},null,8,["modelValue"]),a("div",_e,[(m(!0),x(P,null,G(_.value,o=>(m(),x("div",{data:o,onClick:C=>c.$router.push({query:{id:o._id}}),key:o._id,class:X([{"bg-[#F2F1F1]":o._id===c.$route.query.id},"flex items-center gap-2 p-2 cursor-pointer rounded-lg"])},[a("div",he,[o&&o.pfp?(m(),x("img",{key:0,src:o&&o.pfp,alt:"",class:"w-full h-full object-cover"},null,8,ye)):(m(),x("span",be,L(g(i)(h(o))),1))]),a("div",Ne,[a("span",xe,L(o&&o.accountType),1),a("span",$e,L(o&&o.firstName)+" "+L(o&&o.lastName),1)])],10,ge))),128))])])}}},ke={class:"p-6 flex flex-col gap-4 sm:gap-6"},Ce=a("div",{class:"text-2xl"},"Add Admin User",-1),we=["onSubmit"],Ue={class:"grid grid-cols-2 gap-4 items-center place-content-center"},Ve={__name:"AddAdmin",props:{isOpen:{type:Boolean,default:!1}},emits:["close"],setup(O,{emit:V}){const i=j(),{query:N,mutate:R}=i,b=H(),{validateEmail:p,processNumber:_}=z,h=f(!1),v=f(!1),c=q(()=>{const s=i.getAllRoles;return s?s.map(l=>({label:l.title,value:l.title,id:l._id})):[]});console.log("Rolesssss",c.value);const e=J({fullName:"",lastName:"",username:"",email:"",phoneNumber:"",address:"",accountType:"EaziAdmin",roles:{}}),n=J({fullName:!1,lastName:!1,username:!1,email:!1,phoneNumber:!1,address:!1,roles:!1});function o(){let s=isNaN(e.phoneNumber.trim())||_(e.phoneNumber)&&_(e.phoneNumber).length!==13;return e.fullName.trim()===""?(n.fullName="Please enter a name",!1):e.username.trim()===""?(n.username="Please enter a username",!1):e.email.trim()===""?(n.email="Please enter an email address",!1):p(e.email)?e.phoneNumber.trim()===""?(n.phoneNumber="Please enter a phone number",!1):s!==!1?(n.phoneNumber="Phone number badly formatted",!1):e.address.trim()===""?(n.address="Please enter an address",!1):e.roles.value?(Object.keys(n).forEach(l=>{n[l]=!1}),!0):(n.roles="Please select a role",!1):(n.email="Email is badly formated",!1)}const C=()=>{e.fullName="",e.lastName="",e.username="",e.email="",e.phoneNumber="",e.address="",e.roles={}},A=async()=>{if(o()){h.value=!0;const s={...e};s.firstName=s.fullName.split(" ")[0],s.lastName=s.fullName.split(" ")[1],s.roles=[s.roles.id],delete s.fullName,console.log(e);try{const l=await R({endpoint:"AddAdminUser",data:{input:s}});h.value=!1,l.success?(V("close"),C(),v.value=!0,w(),setTimeout(()=>{v.value=!1},3e3)):(console.log(error.message),b.error(error.message))}catch(l){h.value=!1,console.log(l.message),b.error(l.message)}}},w=async()=>{try{await N({endpoint:"GetAdminUsers",payload:{input:{addedBy:null}},storeKey:"adminUsers"})}catch(s){console.log(s.message)}};return(s,l)=>{const r=y("easiTextInput"),M=y("easiSelectInput"),S=y("easiButton"),E=y("easiModal"),T=y("easiAlert");return m(),x(P,null,[O.isOpen?(m(),I(E,{key:0,persistence:"",onClose:l[7]||(l[7]=t=>s.$emit("close"))},{default:$(()=>[a("div",ke,[Ce,a("form",{onSubmit:ue(A,["prevent"]),ref:"form",autocomplete:"on",class:"flex flex-col gap-6"},[d(r,{modelValue:e.fullName,"onUpdate:modelValue":l[0]||(l[0]=t=>e.fullName=t),label:"Full Name",error:n.fullName},null,8,["modelValue","error"]),d(r,{modelValue:e.username,"onUpdate:modelValue":l[1]||(l[1]=t=>e.username=t),label:"Username",error:n.username},null,8,["modelValue","error"]),d(r,{modelValue:e.email,"onUpdate:modelValue":l[2]||(l[2]=t=>e.email=t),type:"email",label:"Email",inputmode:"email",error:n.email},null,8,["modelValue","error"]),d(r,{modelValue:e.phoneNumber,"onUpdate:modelValue":l[3]||(l[3]=t=>e.phoneNumber=t),type:"tel",inputmode:"numeric",label:"Phone Number",error:n.phoneNumber},null,8,["modelValue","error"]),d(r,{modelValue:e.address,"onUpdate:modelValue":l[4]||(l[4]=t=>e.address=t),label:"Address",error:n.address},null,8,["modelValue","error"]),d(M,{onUpdate:l[5]||(l[5]=t=>e.roles=t),placeholder:"Select role",value:e.roles.value,options:g(c),error:n.roles},null,8,["value","options","error"]),a("div",Ue,[d(S,{onClick:l[6]||(l[6]=t=>s.$emit("close")),variant:"outlined",block:""},{default:$(()=>[U("Cancel")]),_:1}),d(S,{loading:h.value,onClick:A,block:""},{default:$(()=>[U("Yes")]),_:1},8,["loading"])])],40,we)])]),_:1})):B("",!0),v.value?(m(),I(T,{key:1,persistence:!1,onClose:l[8]||(l[8]=t=>v.value=!1),caption:"You have successfully added a new admin."})):B("",!0)],64)}}},Re=a("h2",{class:"font-medium"},"Change Role",-1),qe={class:"pt-2 pb-4 px-4 sm:px-6 flex flex-col gap-4 sm:gap-6"},Ie=a("p",{class:"text-primary text-center leading-5"},[U(" Please Select Role. "),a("br"),U(" You can select more than one role for a user. ")],-1),Se={class:"flex flex-col gap-4 max-h-52 overflow-auto"},Le=["onClick"],Be={class:"flex-shrink-0 w-5"},Oe=["src"],Ee={class:"capitalise"},Pe={class:"grid grid-cols-2 gap-4 items-center place-content-center"},Me={__name:"ChangeRole",props:{isOpen:{type:Boolean,default:!1},user:Object},emits:["close"],setup(O,{emit:V}){const i=O,N=j(),{query:R,mutate:b}=N,p=H(),_=q(()=>i.user),h=f(!1),v=f(!1),c=f(""),e=f(null),n=q(()=>N.getAllRoles);console.log(i.user&&i.user.roles);const o=f([]);Y(()=>{o.value=n.value,e.value=i.user&&i.user.roles.length?i.user.roles[0]._id:null}),K(_,()=>{e.value=i.user&&i.user.roles.length?i.user.roles[0]._id:null});const C=l=>{e.value=e.value==l._id?null:l._id},A=()=>{c.value.trim()!==""?o.value=n.value.filter(l=>l.title.toLowerCase().includes(c.value.toLowerCase())):o.value=n.value},w=async()=>{if(e.value){console.log(e.value),h.value=!0;const l={id:i.user._id,firstName:i.user.firstName,lastName:i.user.lastName,email:i.user.email,roles:[e.value]};try{const r=await b({endpoint:"UpdateAnAdminUser",data:{input:l}});console.log(r),h.value=!1,r.success?(V("close"),s(),v.value=!0,setTimeout(()=>{v.value=!1},3e3)):p.error(r.message)}catch(r){h.value=!1,console.log(r.message)}}else p.error("Please select a role to continue")},s=async()=>{try{await R({endpoint:"GetAdminUsers",payload:{input:{addedBy:null}},storeKey:"adminUsers"})}catch(l){console.log(l.message)}};return(l,r)=>{const M=y("easiSearch"),S=y("easiButton"),E=y("easiModal"),T=y("easiAlert");return m(),x(P,null,[O.isOpen?(m(),I(E,{key:0,persistence:"",onClose:r[2]||(r[2]=t=>l.$emit("close"))},{header:$(()=>[Re]),default:$(()=>[a("div",qe,[Ie,d(M,{onKeyup:A,onSearch:A,large:"",placeholder:"Search...",modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=t=>c.value=t)},null,8,["modelValue"]),a("div",Se,[(m(!0),x(P,null,G(o.value,t=>(m(),x("div",{key:t._id,class:X([{"bg-[#F2F1F1]":e.value==t._id},"border border-[#E7E8E7] p-4 rounded-2xl cursor-pointer flex items-center gap-2"]),onClick:u=>C(t)},[a("span",Be,[a("img",{src:e.value==t._id?g(ie):g(ce),alt:""},null,8,Oe)]),a("span",Ee,L(t.title),1)],10,Le))),128))]),a("div",Pe,[d(S,{onClick:r[1]||(r[1]=t=>l.$emit("close")),variant:"outlined",block:""},{default:$(()=>[U("Cancel")]),_:1}),d(S,{loading:h.value,onClick:w,block:""},{default:$(()=>[U("Yes")]),_:1},8,["loading"])])])]),_:1})):B("",!0),v.value?(m(),I(T,{key:1,persistence:!1,onClose:r[3]||(r[3]=t=>v.value=!1),caption:"You have successfully changed the role of this user."})):B("",!0)],64)}}},Fe="/assets/bank-718f9c7d.svg",Te="/assets/roleIcon-f6a15885.svg",De={class:"flex items-center justify-between"},je=a("h2",{class:"text-xl"},"Admin Users",-1),Ye=a("span",{class:"flex gap-2 items-center"},[a("i",{class:"pi pi-plus"}),U(" Add Admin User ")],-1),Ke={class:"flex gap-6 mt-5"},Ge={class:"w-72 flex-shrink-0"},ze={class:"border grow p-4 sm:px-6 sm:pt-6 sm:pb-14 rounded-2xl mx-auto w-full sm:w-11/12 md:w-10/12 lg:w-9/12 flex gap-6 flex-col md:flex-row"},He={class:"grow"},Je={class:"flex items-center justify-between"},Qe={class:"text-xl sm:text-2xl"},We={class:"grid grid-cols-1 sm:grid-cols-2 gap-6 sm:gap-8 items-center pt-8 pb-4"},Xe={class:"grid grid-cols-2 gap-4"},as={__name:"Index",setup(O){const V=j(),{query:i,mutate:N}=V,R=H(),{formatPhone:b,formatDate:p}=z,_=Q(),h=W(),v=f(!1),c=f(!1),e=f(!1),n=f(!1),o=f(!1),C=f(!1),A=f(!1),w=q(()=>V.getAdminUsers),s=q(()=>w.value&&w.value.find(t=>t._id===_.query.id)),l=q(()=>{const t=s.value&&s.value.roles.length?s.value.roles[0].title:"N/A",u=s.value&&s.value.email,F=s.value&&s.value.phoneNumber?b(s.value.phoneNumber):"N/A",D=s.value&&s.value.address?s.value.address:"N/A";return[{title:"Role",value:t,icon:te},{title:"Email",value:u,link:`mailto:${u}`,icon:ae,copy:!0},{title:"Address",value:D,icon:oe},{title:"Date Added",value:p(s.value&&s.value.createdAt),icon:Fe},{title:"Phone Number",value:F,icon:ne}]}),r=f(!1),M=q(()=>[{title:"Edit",icon:me,action(){console.log(s.value),e.value=!0,r.value=!1}},{title:"Change Role",icon:Te,action(){c.value=!0,r.value=!1}},{title:"Remove",icon:fe,action(){n.value=!0,r.value=!1}}]);Y(async()=>{await E()}),K(w,()=>{_.query&&!_.query.id&&w.value.length&&h.push({query:{id:w.value[0]._id}})});const S=async()=>{A.value=!0;try{const t=await N({endpoint:"RemoveAnAdminUser",data:{input:{userId:s.value._id}}});A.value=!1,n.value=!1,console.log(t),t.success?(o.value=!0,E(),setTimeout(()=>{o.value=!1},3e3)):R.error(t.message)}catch(t){A.value=!1,console.log(t.message)}},E=async()=>{try{C.value=!0,await i({endpoint:"GetAdminUsers",payload:{input:{addedBy:null}},storeKey:"adminUsers"}),C.value=!1}catch(t){C.value=!1,console.log(t.message)}};return(async()=>{try{await i({endpoint:"ListRoles",storeKey:"listRoles"})}catch(t){console.log(t.message)}})(),(t,u)=>{const F=y("easiButton"),D=y("easiAlert"),Z=y("easiLoader");return m(),x(P,null,[a("div",De,[je,d(F,{onClick:u[0]||(u[0]=k=>v.value=!0)},{default:$(()=>[Ye]),_:1})]),a("div",Ke,[a("div",Ge,[d(Ae)]),a("div",ze,[d(se,{user:g(s)},null,8,["user"]),a("div",He,[a("div",Je,[a("h4",Qe,L(g(s)&&g(s).firstName)+" "+L(g(s)&&g(s).lastName),1),d(de,{isOpen:r.value,onOpen:u[1]||(u[1]=k=>r.value=!0),onClose:u[2]||(u[2]=k=>r.value=!1),menuItems:g(M)},null,8,["isOpen","menuItems"])]),a("div",We,[(m(!0),x(P,null,G(g(l),(k,ee)=>(m(),I(re,{data:k,key:ee},null,8,["data"]))),128))])])])]),n.value?(m(),I(D,{key:0,onClose:u[4]||(u[4]=k=>n.value=!1),icon:g(pe),title:"Remove Admin",caption:"Are you sure you want to remove this user from admin? However this action will not be reversible once taken."},{default:$(()=>[a("div",Xe,[d(F,{onClick:u[3]||(u[3]=k=>n.value=!1),block:"",variant:"outlined"},{default:$(()=>[U("Cancel")]),_:1}),d(F,{loading:A.value,onClick:S,block:""},{default:$(()=>[U("Yes")]),_:1},8,["loading"])])]),_:1},8,["icon"])):B("",!0),o.value?(m(),I(D,{key:1,persistence:!1,onClose:u[5]||(u[5]=k=>o.value=!1),caption:"You have successfully removed the user."})):B("",!0),d(Ve,{isOpen:v.value,onClose:u[6]||(u[6]=k=>v.value=!1)},null,8,["isOpen"]),d(Me,{user:g(s),isOpen:c.value,onClose:u[7]||(u[7]=k=>c.value=!1)},null,8,["user","isOpen"]),d(le,{user:g(s),isOpen:e.value,onClose:u[8]||(u[8]=k=>e.value=!1)},null,8,["user","isOpen"]),C.value?(m(),I(Z,{key:2})):B("",!0)],64)}}};export{as as default};
//# sourceMappingURL=Index-be4479fe.js.map
