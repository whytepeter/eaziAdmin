import{s as F,G as R,b as h,D as T,m as v,o as d,c as x,x as V,j as _,a as t,i as p,n as B,k as C,f as N,F as I,I as M,d as O,u as y,e as S,t as g}from"./index-351c9552.js";const z=t("h2",{class:"font-medium"},"Confirm Payment",-1),K={class:"pt-2 pb-4 flex flex-col gap-4 sm:gap-6"},Y=t("p",{class:"mx-4 sm:mx-6 font-bold text-secondary text-center text-sm"}," Please ensure you confirm the money paid by this customer has been remitted into Eazipayâ€™s account. ",-1),G={class:"mx-4 sm:mx-6"},H={class:"mx-4 sm:mx-6"},J={class:"mx-4 sm:mx-6 cursor-pointer flex items-center justify-center gap-2"},Q=t("hr",{class:"mt-2 mb-3 border border-dividerColor text-dividerColor"},null,-1),W={class:"mx-4 sm:mx-6 grid grid-cols-2 gap-4 items-center place-content-center"},X={__name:"ConfirmPayment",props:{isOpen:{type:Boolean,default:!1},loan:{type:Object,default:()=>({})}},emits:["close"],setup(l){const f=l,b=F(),{query:A,mutate:L}=b,k=R(),{uploadFileToServer:P}=M,i=h(!1),c=h(!1),m=h(!1),a=T({amount:"",photoUrl:""}),n=T({amount:!1,photoUrl:!1,accept:!1}),$=()=>a.amount.trim()==""&&a.amount>=0?(n.amount="Please enter a valid amount",!1):a.photoUrl?c.value?(n.amount=!1,n.photoUrl=!1,n.accept=!1,!0):(n.accept=!0,!1):(n.photoUrl="Please select a receipt file",!1),j=async()=>{if($()){i.value=!0;const o=await P(a.photoUrl),e={amount:parseFloat(a.amount),loanId:f.loan&&f.loan._id,photoUrl:o};console.log(e);try{const s=await L({endpoint:"ConfirmLoanPayment",data:e});console.log(s),s.success?(m.value=!0,await u(),setTimeout(()=>{m.value=!1},3e3)):k.error(s.message),i.value=!1}catch(s){i.value=!1,console.log(s.message),k.error(s.message)}}},u=async()=>{try{i.value=!0;const o=await A({endpoint:"ListLoanActivity",payload:{loanId:f.loan._id},storeKey:"loanActivities"});console.log(o),i.value=!1}catch(o){i.value=!1,console.log(o.message)}};return(o,e)=>{const s=v("easiTextInput"),U=v("easiUpload"),q=v("Checkbox"),w=v("easiButton"),E=v("easiModal"),D=v("easiAlert");return d(),x(I,null,[l.isOpen?(d(),V(E,{key:0,persistence:"",onClose:e[5]||(e[5]=r=>o.$emit("close"))},{header:_(()=>[z]),default:_(()=>[t("div",K,[Y,t("div",G,[p(s,{label:"Enter Amount",modelValue:a.amount,"onUpdate:modelValue":e[0]||(e[0]=r=>a.amount=r),format:"",type:"text",inputmode:"numeric",class:"",error:n.amount},null,8,["modelValue","error"])]),t("div",H,[p(U,{error:n.photoUrl,onFileUrl:e[1]||(e[1]=r=>a.photoUrl=r),title:"Upload Payment Receipt"},null,8,["error"])]),t("div",J,[p(q,{class:B({"p-invalid":n.accept}),modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=r=>c.value=r),binary:!0},null,8,["class","modelValue"]),t("span",{onClick:e[3]||(e[3]=r=>c.value=!c.value),class:B([n.accept?"text-secondary":"text-primary"])}," I have confirmed the payment ",2)]),Q,t("div",W,[p(w,{onClick:e[4]||(e[4]=r=>o.$emit("close")),variant:"outlined",block:""},{default:_(()=>[C("Cancel")]),_:1}),p(w,{loading:i.value,onClick:j,block:""},{default:_(()=>[C("Confirm Payment")]),_:1},8,["loading"])])])]),_:1})):N("",!0),m.value?(d(),V(D,{key:1,onClose:e[7]||(e[7]=r=>m.value=!1),caption:"Payment has been successfully confirmed"},{default:_(()=>[p(w,{onClick:e[6]||(e[6]=r=>m.value=!1),block:""},{default:_(()=>[C("Okay")]),_:1})]),_:1})):N("",!0)],64)}}},Z={class:""},ee={class:"flex items-center justify-between"},te=t("span",{class:"text-lg mb-2"},"Loan Activities",-1),oe={key:0,class:"max-h-96 overflow-y-auto mt-2"},se={class:""},ae={class:"flex items-center gap-2"},ne={class:"w-9 h-9 overflow-hidden flex-shrink-0 rounded-full bg-tertiary text-white flex items-center justify-center text-xs font-semibold"},le=["src"],re={key:1,class:"w-full h-full bg-primary flex items-center justify-center"},ie={class:""},ce={class:"font-bold"},me=t("div",{class:"p-6 text-center text-dark-500"},"No Activities yet",-1),de={__name:"LoanActivities",props:{loan:{type:Object,default:()=>({})}},setup(l){const f=l,b=F(),{query:A,mutate:L}=b,{formatAmount:k,formatDate:P,initials:i}=M,c=h(!1),m=h(!1),a=O(()=>b.getLoanActivities);console.log("Activites.....",a.value);const n=u=>u?{PART_PAYMENT:"Part Payment",CONFIRM_PAYMENT:"Confirm Payment"}[u]:"N/A",$=O(()=>f.loan?f.loan.companyId.company.companyName:"N/A");return(async()=>{try{c.value=!0;const u=await A({endpoint:"ListLoanActivity",payload:{loanId:f.loan._id},storeKey:"loanActivities"});console.log(u),c.value=!1}catch(u){c.value=!1,console.log(u.message)}})(),(u,o)=>{const e=v("easiButton");return d(),x(I,null,[t("div",Z,[t("div",ee,[te,p(e,{onClick:o[0]||(o[0]=s=>m.value=!0)},{default:_(()=>[C("Confirm Payment")]),_:1})]),y(a)&&y(a).length?(d(),x("div",oe,[(d(!0),x(I,null,S(y(a),(s,U)=>(d(),x("div",{key:U,class:"text-sm text-dark-800 grid grid-cols-2 sm:grid-cols-4 place-content-center items-center gap-4 border-b py-2 last:border-0 border-dark-400"},[t("span",se,g(y(P)(s.createdAt)),1),t("div",ae,[t("div",ne,[l.loan&&l.loan.companyId.company.logo?(d(),x("img",{key:0,src:l.loan&&l.loan.companyId.company.logo,alt:"object-cover"},null,8,le)):(d(),x("span",re,g(y(i)(l.loan&&l.loan.companyId.company.companyName)),1))]),t("span",null,g(y($)),1)]),t("span",ie,g(n(s.type)),1),t("span",ce,g(y(k)(s.amount)),1)]))),128))])):N("",!0),me]),p(X,{loan:l.loan,isOpen:m.value,onClose:o[1]||(o[1]=s=>m.value=!1)},null,8,["loan","isOpen"])],64)}}};export{de as _};
//# sourceMappingURL=LoanActivities-2c0d1c2b.js.map
